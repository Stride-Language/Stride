use DesktopAudio version 1.0

signal Accum {}
switch ResetOuter { }
signal OuterCounter { reset: ResetOuter}

module Sum {
	ports: [
		mainInputPort InputPort { block: Input }
		mainOutputPort OutputPort { block: Output }
	]
	blocks:  [
		signal Input[3] { domain: OutputPort.domain }
		loop Accumulate {
			ports: [	
				mainInputPort InputPort { block: Input }
				mainOutputPort OutputPort { block: Output }
			]
			blocks: [
				signal Input[3] {}
				signal Output {default: 0 reset: Reset }
				switch Done {default: off reset:Reset }
				trigger Reset {}
			]
			streams: [
				Input[0] + Input[1] + Input[2] >> Output;
				on >> Done;
			]
			onExecution: Reset
			terminateWhen: Done
		}
	]
	streams: [
		Input >> Accumulate() >> Output;
	]
}

[AudioIn[0], AudioIn[1], 7] >> Sum() >> AudioOut[0];

